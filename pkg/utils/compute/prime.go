package compute

import (
	"math/big"
)

const (
	defaultTestTimes   = 10
	secretMaxLenNoFast = 200
)

var (
	fastPrimes []*big.Int
)

// 递增地初始化一些不同空间占用的已知素数，用作快速加解密需求
func init() {
	fastPrimes = make([]*big.Int, 0, 42)
	prime, _ := new(big.Int).SetString("AwGeptL1TMEBFSqZfp4BXWGY80D", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("bp4BIde7QUfxFaGMulAG6mXcLgIclN9M8j", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("3yLcGnEyq06hbqngIyXNqhUeKJFzKcsuGSD1CnGan", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("16VojPatgWtwXcxnxocPse5M8CZAWEv6Z3VKi4xumNW7FQdf", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("lwegNercKn81SX8boBDos0ksm0cQpaHm7Nu6qJPmJMk2Kgz25o4ggX", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("6IznUBFJvXlEgv1jFCGH4OsE4zPmhPVcHvcyrzVXPOMjCuu1gZxZgbq1CAWmd", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("263M6rAkafjX0vtPBzMJ1DjDEa7Nou7PPzedP6hGWawQ74IGy36ByU1uUBN8cYnahSrr", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("EBEGXHDtAaZMcVEs1ZYx0WVnBxM6ulVZPPQqmkfYjPVSZBZsdTRB5cKmRhR2zJlXMUSMkub4vx", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("cG3zX2IxSBqUNIojtY7wTHmb8NIie4tRODQe47WX4sDkE60lSa5J5bCsZY7rwE7JFiSb8POjIZecbiwzb", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("1eCKtmevq8JCaHsG4M7LaoItPW98tY9sFXMP51SHU744zuZkVBjR83UBUsauNGxZVLWlUY0RQJeXd3xzrCVshJB41rJmcHV", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("7t6q9Yg7hpdczJqwuZLjbtcPtt9zRiCGjx7jbfMRDTIVYKOu0GCEarjarHcoC6HQh4tzMu07S2qfvvZQyJ1EFLF2V08DX2E9zNGf7C7aIUOn", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("J8Tb5MGpxCyIY2pFBqUb7x9SEYG5ID3ehjhGt4VgN0hSL1zpytWcCGuyyJrnHRFyU5z5sDzN4Cxj8mQxECdu25FaA9kzpSZCF9q8F6rkeAeV5I3RW50NVEEWN", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("4oPPXhCZsHLTW96ahHGDfXBZxOZYixGBnignbTzQ6XF06L1fAHysU0YsBiUppygzjGKQndYGRRlKRw9vYmWTUqml2eeFw79iiICumWME6gHKwov6FLS4iHnuIUQCte02Pfupr2V", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("qAXnr1tPpxzrBRhsOWeEwlcK19OJlNhYkIBX9FjYL74dN1slhyYr3I5tOlvQB4eNukoew8hGpSqXGcCcYE5qyU0HC5XcV1D7aYAJt2Fd4SkEB4G7D3JhvNKIQSHkF1kHG2pLF69hfTGdwePpffjf", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("2AJULLRuiEdzBbA9MTKVqSYqqkyrBr8wNFNBj6y2lOZn2TO8yhr7Kqe0ArLgUZKqIYKXXIiRCeSfYUw06pz3Gne83uBki1cCqm1ywRk7QwnHk0aUA0SL2uC2RdX0dNznz3tbnBS5B63euATqYsmskP5ExjU75iq5G9", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("ObxoLSR38Vjstir2mhFGqeiwcFPVoQsKkkXT8x13t2WW4ufNcbpd4lMmc4FhjrKU5SSBXeQmAvSE8zrdFO7BCHQFLX3DX3FiNQ81B5Un6H4ByVDjBXIoWDCNmb2grMgIQNrNHfcss1Jz9DB1jwj6xoP1TBsjLcq3D6oVsTrj", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("UYShNRSeJrPWRFR7lSLuwaAjiGhTGHKsUp5bHtQbPHMOWlYw54dyiDJ9Yhun3cZU4jlmj2Fx01vKUVDLkBHJPbPh5oA1hAPzBH6XFQHJFR7KIRIZipsf9921RoTQ3TWUrDAuZOTFgAJhswqa0WQzFGDsbcUN9dW21aielkO7dgKX", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("fFtFthL5piR6QfHLJEfW8YEiTdjF8er4cFcwjSXinsnB1LHj41Tco18PrpoByJLldIkUr54P0KI3IGuaI8EACpBo76BvpGG6zDAS41iplpHjjS2zBGJEJYWD2FoTCQkuZoU0lQHV9VeYU005SMrCUlVJdwEMD8YczTgyTSMkeeQbXwL", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("1wHo9vkBI3D4BSUOgirtGVhQNOFDaED4YV3kQKReZf0mQe6pNx9nh38lJVk5S5n9PQEZtaj2uV4NILJGdftFeiaD5mxT6M1LJ1wkCWVohY7jroAez8Qqh6lg36ruCtHyks3WAGRzbxVAjPETUEYURbXhfAbALBdpX05HhXWzdjx7hPYslWcclODHMORzH", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("9elj8jsXBRaN3o5Hnq5tBJHTBCUsEdTo6SOx4VNZw6DHLJDd3pNEaTG2CRMdCuTfHu7hsRIGKFB9jraCRDryilQb9DLcTCiEuZeS0XAqkMpaetHhNfrGvqjDcNrEyOHeLNJceOZVjS2WLDu7wi7MFmKjFc2KMqFymfBSmgCd2qDg4mRyIneF1whQljW4wUMg07TaBWyO4X", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("TN6VoaYM0li2RYq8Ki7pTrRl7JnOjTwlBfs6J0B3rSLM3SWfSzgjNq0tWUYiTLWaa43k9P7uNcUnXe8ucqqtteY0mbiwELYcdJnoKOa0Jth7hdWxgkOy9BrDe5OGnOFKRRlC4M4pyc4KvBSak9yA6R26r0qS5k1zAuHrt1ho2sOoTWekLPxWBQ5mMuqb3R6lOcbzJNG7UsUHUa2x2jbFMhN", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("5rc3YaA7sKTgqKz98b610KSf3t14pAkAlveTN3B3qrwYGE138jDOoQ0hKrHuKnFDwPPaNlBfzhRLtRaxdARRJTc6uiPoNptnNAWvIFrJAo7VK8oKNRfDrvG1crEhtQJsAUmzH6oNVT3lhLIdIv7HQaVh3UQ0ItI9x4otAsFO8RNIOW9aY9Ld8e34WpGQvfOozYzoRn7aqQiCm1zFIY6x2nb4gXWm6EATspLYt", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("wRVn8mSnssu8Q29Kham6yH7XnHNEb4w77K4ZwRH3TVm0ENQSlI6LXWe2IVAafon4pVwXnpVBtoSb0XgiRxKKLcppuSfZLzlMCoq42qgBlq2cU3JtFXqfS0mw4kVsd3dFZAgAgTPxMUvOPsgh7jSGjyXoqCmnYEfiB7VvjQNPUyfDfz5EHDr3SDYhAneeclaVlsbUranPHIq2NHqIczzsqQcT7xZmgTnEUxTx4MR22S1dIL2OVR", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("3cEKdxbNL0hXVOxRKenbD64qqvRoVit9OioS4sIZFIibmkyXNZYd7zkAgpzIgqLcz8d8WHGd8I7X0pc02fUoMJ0dXVod3aqx2Ci7o3LOmvKssKchi9kuwvVvNSx7WvRvHLKVP8jRA02W316FzviDLOeubeon51jYKjNRnaBLXjBkzpFyFYAeyYeTLz3rQ73HtMNXXJokGitT98OhnOXNenpNwLurtclWdeXbX5iCPEAc5jO0mT7bBZjPHjV9OSfx", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	// 若是没有开素数fast获取开关，建议秘密字符串len < 200
	prime, _ = new(big.Int).SetString("jmDxdlKz7LDiuoOOQtCanRKR0lg2FIcC4Mv4U07BoHxm5SqJB8Yw3ni81kYFOeglqS7Jmjcgw5YkOXT1BdjiFebJDU31QZbylnrUrHeYYdZUXwzhgkJll7zjfE9clKdnXVLNKxdWy93SnxaKiny7U5YFzsCwSng3v84jUQrqWQKYvt00duKCaWk7xslaEOOYsSsklW29haWMoYx5jG1jcy8i5XoE7OWjNZO5VxfpsEOtKD2O17sCGyG3sUwVIY4GUiBZS4sUMZYyX", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("ECE160ZTXqYCEQk8DX30xllVEsgM4LctUk1zu9HpBIWMEHzGBQ1Ue8Q95ia2T5JKl5nxXedq2xvq3RHfHnh3LtcqIuFymL5n4lCS4XlHOE7IPbEeHb5yd0ZS4Qg9J4XBzcNPGFLsO86zt43LZ5ZmSWFxl0G0Lp8BfFvJU42LNplaf5Et597T6FkHI5wmJFLZ8WpjIKrtrlR60aRL0hO6KjrGAXv7VnoZnT80gtMl58wxIAkyc08IcTzmRIdljNtR4aIbZPPdE6e55YpNQmEJqplHj0Rqas5ivgADMc3nPZcapAq9CafJ8qWJUNLOJx9EGHuZK7BLOSYBYXc5", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("1ndvinsJGzMUGS3Mi1mY1rQ6QuCumbvLANwjsq71lHf8iLHMVnrle4fnf2xjP41zLSM7TU2QzCRADjV2GdoywGYOpLOW686M61trJjFzWfCrlTwjjBbVRCI14GXmK1GzZZwehspd44Q3f5oghSvt3D6ZX9tBqHHELyxUeC4EC2iMvLdye80fy47NmrVoQqLHrDCQ193nDfphuyt2jJAyazPanJxeIOmiPUkqF1l3QPKRajl8BmUTZVkoE3gYcFHaqncdO53ZnGvXqeH88H0RHKpxOw5BlR1sXZtEKQlnHtrLINa8bRYfShcVGkBnbFCghBNinyfpuzMmBbB7OFTkioWdLwnxizWoP5v7pmVz69WuwhUlsxZtZLG9k7Ta3lF3dr6w1n9DRALxdySjLJGD", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("2SLvomxsjCttZG5N1EBUFVxqrlkLKrYnZjPMDK7lVD6BHjopeOF1im2DXak2EddiGkuKzSg25cUR0z94DoJznFPvHN9tHCeUXe9HgoKyplsyPZm3RpFScQaW3yHSsJcjOZw0TH8fIe0YOBqdLyE98lUBBztq0orLFwOMhSbPKfaimluTGzJvtMr98qPfye2gfNadrsfm2xlgS6rHCTFC6U56zeDHumj7KBXr6Mhjv8oSXnw2AXKpLUGiL1EU82EEQYfHi2I44jMPzbaEh9zAHpVm2Ccb3pTroyq8R1y404Aw3kNfcJwzR5F76sh39DqeP9dgNbqT4y7v1BshbMuX5FI4zv6daJjxIBhqkbbatzu5NetqYKggvbhbuzuIqcf828XYi5qHI3VR8lBUevSCJqstkMaJpZ2stfaDE2g3xhjoGaF4X85SpHyzX1Od1hN8UCAqIqBtnvO1B9ijWR8Cl03", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("630uOXSzciIdfVyREWC8Deq9PiX9YHmfrtfBvQscs86wp4OPg5oQiETRQJoPrPO8H0CFG7YwYRKSVCXC4enhiHklcT5bgdVbz8377g8ypG6dtAVoyLFG3v2jy1WnUP547WbZ9RlcT5knkDHOSgn3au3i3QxOFpLgal4n8da5R8zqu7RbXph3DguuivGCy9X1iPWZg8hVXHqjLRwJCUQCyVSay9W0PQVGKcLC91xPizSATUsrJ4iBX4Hfj3qOdcjfWbslceXBqCj4ZotFV8nKJ3rn0lywaS0AQfPDmibmmunvvdmsPbsD1xlpsob5xnVi6S0SkqvWHqa0fpJCrb0hj89xGMYg79Qf1Ejv6xp7Yz9GhHUdivU8ZkzS3T5Y8Ei5mq6ZuXV9M8COyThq9pk9d9KknBT5h79sqDK1JR9aK5inMUWXbLUanoMi8gaOUwzNrHZzUXBmPRNgyiPg2ACNz2OiB5w0amQu60qKu8i18tUkfwe1nWfnsD2VBPc77M0kkfbvikwHYPbOHQbVByBkeCMJ6D", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("cGFSBIMGpLJhGsj0MdckwvfeuiqM7z6jc2V7QZjL5YSEdlkp0esEqzwdQBSOwjamJZrcnsyNM2H67N2YBOzOs39KLKhv8BOC6QfQotcYFkzklcP3n6JHxNEfn0chLN5SJ7ELncjBJDxbs6PNZuVNQKtQ7NfBS4KeQ6lY7pPBgQKqOp23dH6L0UXPr5CYMeFF7uUbC63BHQYhGMNXfp99O3rddKyYAnr8G0xNsSrAhFWYPhY0MwqzTcD1ytASKjAavBna0FwpqFgHY4ZhvZU2SN04PtmfupH4KjySY885CYCEBM4RYlIks32rYxzuts4BzmeYa62Aoq1rDKTJgpRhgO87TqcD3jmoVtGFRGTcnGy3UYT4sD1R1EFWLCvzQnMV1IT7Wjb9id8VU2UjxN8WAVhLhf6BGgAa44jevHHMQ3PCtifj5rhDvM2NMgxF8eOTFyuiQFHMhrwbkqn7EFBFbrH7y2YqUCzm2wZlcRoebTUOLjYl43w6UUk8FefOfHVrb11o2H9ymDG3PLaFw7CG5faEkAj0WGU0KuseuJaCTOxJey8UczzweOPgdp606OFpePTtsRA4ftprv1FZIfR0NSqiEwXPV", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("qCfISW4SzM3MKuzgBRg4l6rqcjeuzdhyxSnHkuda0JWTYdCVhZlCmFeyEfLnLLVlEUFfpGEPVOAX9H1tNlRAy9ApsgMFvy2BrTuwMKLcXQgaPiSZRcWCE25GyjnkUX8RffUI0Xv3P9KCXcfO5QybJWYl0175B1SAYLSZzFynpQ6SZOcq7gb5u0248suaGiDAPNtnY35wKNMacJwk3FreWhfTqFTbUjlf4pqT1tvSN3X04jtszHhtyTD5TIVyTtIbG9LBrx5QPAuhgzmvWxRsujcrtlBUd7aENeXxdpmrCyCuZDD4RdfQBTaU6lIwd804egVzvMJTik7tJLCpL8Sitv8zocKL3fNiP45s3zfkTdnbV3cNWS7dHFR2A0nanp5dUpDP5agpqf0GRW9r4rHoHvtJBdBmtDSBGfYOduNXXFytMdeMz4JKYa2rmfeiUcswidmRXekCI3cnu2VaJCfOC1NWv4ND9OL2YXU0dzEmnoRW9mtjcxwb5WJrt5YcwSmJzI0cMSZ6lU6nCNVRylTqHWXM8PGiEJLrlVKEyvE9MRx51H7ARa0tVGcsNOWi2LOYJerJcv2WXXDb3jzlKPUlItmYz5G4fYxdYXYDglYUkgeB2PAeZt31PWr1SroKKXZFYhnSVzzvk0PEn9AMNu0VKB85Tbdq6Wdx", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("TPPtg4XDmRfUza5cLAvfE2UQJenIvUBietpy4QNftZGaoQY2S1UAUKcO02EwpTmRK06ES82cTuok7046TKORxyztNBaCA0558u5ErFKZ9PKv1EGaeYcAlISTfHvevHFkURIzvfRQZ0SzkO7YJ4xjzxMQedR0EyPk6XPduHkUtQaP0n0n0mPzeUXNYoZWzQiTBdYffGpEbEcOeBhoEJqPc82HHlKsWIqXpN1NiuyH4QwhaGIzkWfUls0FeO3u8mLQZ95pEsz3wehziixypvXfkUkXasGM0B6OeHcIWjnc5sQFLLBC72UWIZK1ZokDKsPX5kMlF4PsczJbxTwTA5PScU6fL3nw3bZ8qUmMRGQTo8G1lYZhSu9bWyPhlv6Xs0nEJzSj5miOhvVCKpLXws0yyCkuJJIzYc8nHXZUzxosdMur619pIQCkO9c6O5dDUw13YqtVRTkprQBXjufd0uTk7UjE6avSijlaJI5C6R2SNV58HpVmvQa680QAPByzkxVfKN1Rp0zHKg30cZ5aadq9w0Scmttv6Q2DRV1IB8HXK3kGcPhI6GRJi23Q2RISetEdGcuI4YKGXUeYQZNS1YQoiQa54S2N2Xszt1ypQQ37rbkHoDBO5nJlXH2BoKl0JDW8EXhYZ59RNUzgNjFnzJ46pognVWo7JO97iClK9XRvAyejzERe9Krw0YNmm2hg6Ov5YflBaXYRClvYcUi2quiNtjEsskvGCVrMMSL", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("1T84KLQ6epeLGpYInFR8rE4CFweHzVdrSXOweLuW1BiXJiTUIgKzisvLXUwriXutM550HlRywsXapQ1VfLTICppq4o0jsLNzBPkTftm8Q5rZeSR92H9S78RPUOO8P7xa38x0QxhsIfVwkTN8GkRAGAOkX7XM9QC35tltZ2xIui6avWFxNDB8r4LgpdoeOms7iyIkYvwG9hsPlKu8yX9U7bgJKBJh6Bhzn7QkeCzm6tUL5KnwHELbwXTl9oH7TDQ6AwjKPnnzlabWmU6Vj2hFI0wTohsWYFRMRzPDUiCC4ru4fx7w68PQMxkKR1EhLQYiSXOoLalqe544jym3hukfJoiVTM1klWb5qEFKwKJhN6gvS5k6kwuPpNxVplCYKv8sIo8K8KTcKSI3aZVIACdUhH2VFDymhZOcDoAUR4lWRlj3LEjlS0eKZyAXzSV8CTWnZV6L9H4ZnXEee2Tt9d91jKO1OXcM0m5hPdL1gZOzU0K9BkMkYCCwKL77hC0I66ItGbDW9omZrGK860YTReb9Adv2KECmO31r3NN9Xn9ggyv51TYuQYLGTXwFbMYG6hkoARzqPda8zjHL9dnZNImXki3JZkdKfkzMGuv1xIYat4FAyaDSKCZrVj1EsZOYbD79UTt8dUrWxvUZo0qzHGnq88PxAhrXILYFrvSl6HwWhLqzsHGp9GIohp2E6b764gTrhK97L33UkbRErwWDoakoO3bmtPsNzOdnIOVBhm39iTEIeQ5wms6F4PZtdyhlGfVPY0gIWqgy45Z45e4Gfv3MtWA9kUU3pxHYU3zOpqJ", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("3XI4eJ9n0zfUFXxVFwrkBUrwJqNisD9WhesUGOGKdCbOWEYERFusAVgMSEMmeADqFEga6DUXKsdIIyeCtvSnF7XlB5j7QiyC4PNJFXHXY2TwCwAtLF7v7qEQyEtSWpTs3xOiUfpMOwqGjkz8qE89P7cX3YL0abcRh11wheebAeIhnMJqURlccimAekwjojscx7D1hrXyLQ5kdSuXxUJd6xxYbHvUrnroGh8clvVlK5QFPVvvRMMyTK5ga49Fz8QSDNwddkMuiQqxtWaVmSP8e5nVpHSPzivswTu87iFFU7JKCPnDzUKiy4v83wUPo9grZ0DRYQ53foeAc2hhWpDgIXyGEZwlMchmVOhKETgNtZ8TAWvLXJs0gx6b0zf5r2j3WmpV7pCClGJl9zFsAtQAfnt7RLRM2MyefyR8HfhXljT1S9INFVLdYWdRnRTzvc1cc45PJQujTybIChkhWJ5rOC5Rqj5afuxEMsKaSfu8HERlzm6zW9jaEQMixAwQ8OcJ9Safwdg1Dz1KFrF54x0xOX0nhOqf8VDh2TWnyy8sbphu4MJXkKYiaTzYaFbEk4Q2PD3EAX1mJvfiykzP8VpgjZB8njTx6oiKUUAPWxvHkDIhq6wZ3tFXGuwy4L4bTP3LOtqrdrtFO1jIWw8gH7p3VvE3xCDW9vLIc4HtRaVBX9sk1WKVxU6LPYrRxCYy3j07o9u7osspZQtprNoxwArFbpP4I8jObF4e0zBBHmlwibd8A7jKjmFEoHbZOq00VYWtYya2bL78C7rOK7sC3MkJTMbFPXJkKDcxX1yK7kt7HfoqTioLKy9phgBlHn9SC4w9Ktw4WK6cuAbYjSmKhZqZHGOrpkwfUSggejDoOYrOKB", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("8jrmEKfNqD5cKb9FLvMgnkcP1TllkYW0pv89IroLwCh8B9SmPK5Yiq7W2qkeIVbtwrOqXXXpFQCnsuJDsF6rALokI015d8NwS4Xg3WU1vV6VGKGAibVV13BewffHKus6isTbPpdlJOcsOH0PB1GEMHu0wxVqOSariKymaTywmIgeHYsaLupQriq20Yzr6kKmTPLMj6U61evvRSrValTTCfA7p3UtdmGwFW7byMFv8Xh23FhrcM4sBrZnfDe7BAGjKcI8CZduVkZgs5Ao9ddFSFGQhHrIp8T9LfjCDKAFtKytbWXIpt2hWjK6WZMF5z3ryfk9Qoz9qqSww0DDQgebWM6rJWEDZ85duSck2jQa43vsDzg60ThQtJU5NJCLVdfzKMU2dk4syICd70IsGcLV058VzcdyzTWTrrLdA0YjQ12Xni6BwBfd0syDbLgOvCgOQC30wQihJhXJso7J8MuyLMKC1ZwzqwCdQUL5TL8IF1JBA0BF3rk0mSgVfyWFi4zXLwvQ3kAvBfEWxAz0O5QOopRYwQHBbzMZOo0ZJDS3IRSCTOmrr160k77LTmYYPnj8WDmYXeU5QXpGngNf0k5kMPqWYmnmhy6sOVAWAyN70OZeCSdDRzDINLUe2c2FzimxqUKXssQtg6jT1aILDHFodBt6W3p3GEvN4sfzeRFkUiMIX2in9BIW5hbS9JFcOhyjEb6DdriMYayf6mgI9Poq9Y4BbGLtwCSxfe9Ma37yeyqIJXwIkbfzWvI7Dh5P6DOEGmgmDa3ufD9Oh5kDPvBp0f94NvmMp118mbSDyDhkpee74zieAM7tuGLFiwQG397IBzKnTdxMlnZMPgJUuCXpDp3MP1QN423qJEYDGykx6FodFCMfWt3ZPSWYnWgad04UnyeMLfUsvImkrcr5QsS9n2ibEfGo4KumUjULlr1V7X2W9", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("hrgLKiu0yQWeraVNBd8Tn3MbK2xvCBouOuxV9U7NQSY3SWn3YnRHebBorjH4Dr0p4RwcSLSTzaDCcYyV58gTR6xO4SYQGIP6mcgWSgzCprFHUDzmBREBsJ8cIjwYgOx28bZkncngEaLBfatt6jID1d3dKa5dKnPx27zjJ0vMszmOvgL0NIRwXUmN7QnafXOwutz8rBTJFEtsUUHFkcwYBcLAj86I6x1KM02P7YtcYJOWGEOr66IKEkmJVIhybQiz01iMFGzVgx0KQhAmWF6iN4FMpZj5oXVSiYUkMners6Nr8TLrpbiDuwiiu0CdXbXriBCcCkiaWCbswjabonlVxT7Cfb5ea94e3Rro5ARlf0Z6S3iNYiavyRRo7EhU4DFnRWIJas4twDOAYlfmKTnN17juDIEc4IOQbW3bUZZq2KVudh7nymBzvKozE21G3RpxVIFuD38wTsI6IghYCBss9yUSLcACyqBHlmxArqi7srqRZoQbCd5y2jgKFTXZDexMn2Co087DKbE2BV94ZWulresqFW5HNFBQiuU3kM3Cx4LmswCvFLmsWyP3gtW3NUhhAAdgU5oeSQ5sdPot99skwjBorOJufkSXauSD55SLftWe0wIBLjZfhrxSvIGazVBjmEi6CHEBzwz40NSfYbBuSgmD0tg6P4jq8t3KfbhIKvZ3RYLAn1xDucrgdJcggmAWdhv9tR8WFiUWu8pracbxqrrcCpFqAzXRzijV2ONfw1Cx4GJOyd4ZIwGH1ZWNU5jIOQzEeNlezUs6Dxyi7KL4IlAIpdF3muNyczAnkxMVqjeXfYrDwr7DrtwZjCseEdqNK9so4weoIrhIYtUDAuMfysJQr6XH4ks0r7dx4sGIcvvY16DCZoc9wJ24yU94azZLjoDY7aJH6L5H5oMNqwH67JmhgqxncM5mTqEDlO5tVIgPZJExrlNNdLEgmM7zyKluPckIITi7r3lK1mcDhBHgFzroEtyB86wDEg3fW8cgkDrQA80d", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("AAf0QLG5D8h9kHuekyfsrc9HSWfBmfvsNQDVcrFXXplWqleGhqVowW0ZHz7yonTE8Bhn75ia2yXx1rim3WzEg8SL5Na9DmLoNJc8kLED6Y1wvnAakOldXFwfAkkeTV7k9tnOzwTrP3qAa4ttSzQ1DFIQ7OFA4Xr1yEUnAOvvcbIr3sOgSTX9haoIGReT8HrlwbaBWUwvhEtrPpkhBAJHT6KEo4MU6QBrQfik0hfd80rOsOUmsu8tofq8KeMHZPB31jNsP62jOXNG0oGoiG8E21N6IKYQD03M4q7oPMawf9iHIqESQKDYUHB39VnQClUUOx0OKPxP5l5qnzlImYy2sT7ZSLdcey2JB0ZKAA4h6spPr3i4GdY1IMWHs6RmLxbh8CNx2LTFGZ2cQUTz6aTAIJNLN2u0BbQiIdyH4BxQl1ZZP7ShoUiTNMFiK2nZM1AL30qTHfnE6hYmUZtnV8MLqNweI51NxcoszG7Z2yBvpxtOLgDztI3G8qn0BwJzfQNCOIQoqPV76Q3V3IVxOlw7ffT0dn1VtXVPtLIlFuF8wov3huhsUDuE52W3oWPseHQD8Aj8L5sHWJg64Yw0arAb3n3OdwPE1MBfmEy6VYCXcdJIZGCV4H8dK5h0QKGnWWlwqCMh9t9KCpbC97ggtlck2jkBWfc8YBWdTYSDx2goE197qEQz7Pxm3nTPgrot0a40iVEanEhRCpwJmDdRm2W1wsbIEN0By5S5GWcBxFjmp87rMOQHzzGCiElc4iOLWK7eiZVXmscr9Byjbi7SOhLm4Gy4Jp1KcXTMDqlZ3pDf4dymnvdzmyHuBiFk4vElxvS73r2Q3e3zPpbQDIw8lQzzrEtKabS8ReYh8pcQCGcbeBh34rYmfLqHBkKBaAHSzfepjXlQo5JFIG6U03gvP3l0rc0a2dbXHF7O3fnUBfUu3Ajvc5xJYAmddhsLaUEaCpStuCcMt1dzcXg85faP1kxbFA2RSAL57iejSWxQMIJFxFdQaSh6kTw2z8OGrXx8ZupkhK1tfuzhyUudgkWckZRzPUNTROP5yNTfmc2E4j46b7NhvNgAZXl", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("1eKdCn5QYGJjVYpf9fPjg1jCA4NASMPJMcdGASCntfdRyziDVDZnxujCQrReBmcIb1Cr4wKTt2iOI7SfvQu5ur3Buq7aG66LLB5ov7mV2Q9NKSn9kB55zS06fF8yTtmpP3d5WCn6Le7y3QD6I2ePAvX4sirz4tS01hD2CA4B7jWm4PxQKlunsYMaVr5Mie8eheGTn3V3dKRlLJ1arxniIGLwkfpyUrY0ps3s7KMLCa8fwqBWCGKZPaqVuzEXvLwoOlKRc3MWA9kNAFBCewTWdHxW9rZq7UYxTxw5QLg57rPjScTsEBeD8vt0HyzccnkZaY5URBpKfZjVXa9NJKczAbos62LKgwoIuMKxVkXRgxa05B12DoZUkFx81D82A700DbQKn5hRipx5jl1fa9qxfoHVs3HQsg46MKXx6ylHDZFd4GUYXoiawE07J2vgC1a2jFulZNz0Rnp7iHHMGpJUglJn4oDqPdtp60W2ZOYhmL2gZCzardzkteZSwwEn5Qi6NFx9rYBPrBH4oHHJ0anxxJcxka6qRDwxBLO6FEeaBMPALe6xZeEI54mWNHl67LKcl1HulKAkGHd3DY1m5xEu8fuA5phg99nNIc9EveGnCFvJoZ5fUJ5GBjWR6qILCCFfG7AhKsv2wVJFh5jvdkzsGNAU7XV8KEdO5kSSQyaeEkQbNkEtPnTaDgQx0E0BNi7CbYCvz0YYYEFPrnguY5x8ZTKSGQJqIBVg9HapHwLPawEigFMrBtmNB3IqYFmNQJwnmc57IlWAetTcwegqdAmDZuU16Kmq6aI5RaDDsIuiCHfIwRAcYVzGJWxIvxg98qQEWc60rpvhy9Qjd8j67b0jxYXked4EfcXyytvMnhRJdNMEmgrCZoGeMcKlATISj56tuVu0hvBVc5dfn79DSu4pVCSzL2a6T2Eg8lUpV5tF8aEUi6qw5K7ebGDfDJ8yThPlHKqZ9xRT0t9nUITT1XLulvLaWWuFSAIdgFvXBVI02GFBnXPWx3IrB6xyzUhkoi4HVyvyKUTOyyN9npokzXezPbwiTPZFwq30lCLb6k9KZ91dpKxvXQdP5Drrsb5A2jVDQMbySvfULjtvMljyDZoPkflJUd20ZClRENDOehpv1aDzg1ZS4xQfAKd", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("2AZAkSrvGNgCyCrnPrrBOfR3f5EmyC8MdcbR3DSIHjm2dZvkSswXWjcv55B4jm9Er36KpNswLNoEwemrS8jlJF8s8R01ZyZvTrStPZXTXhvV5ZnjZl0J9AXWCJgMelOtRVFZG5pAS7AvgAfhEeOuqGaZFbotoW1j2YqYjgoY5WQzcKCNafzUZbwls4NGG2gBqEHWnSAfNtBjVdEKsIV1oBsjI5ydZcDbU8YI5eWTVEtKrWzDhoSjYZRfFlT8jb4hlKFTLz93ZrzL0dhvqUeQC64LK1PZa57AfxKxfkFRyXhUWakEHM5v8D1rzjEurPy3WshB18hk617LtTHeFq2s0HmXwYJTCdQqMkfB3TQH147HZTXPK2ku5d3n55JEdLBoC3j4ktUB7sxHHJkQL5DX00VDF9tUczirCJBiYF3yAS6jLLzHxYwHWolq07IrR7EsCIKaHXwxxP3DqAHojJM0NBswZ44MZjKprwwJ2Lmpira8geFOnLOa7JzXpbO7waRbBHF44hYdoYvJ2H8Xr8OjZDA2Jeq7QaTjHy5D4OYWyMqNLBwlTBQ2HznckSFBW4qzoHeUe0bzpEgN0cSZOw26Sry0KrjiW2zIzMmjbfsIUc015dXaxpVgVNDzN6H7drSnEm14qrTYUJAgVW9lsRpJjKBAm3m2DBtViIp75loqa3Y8D5KOwr7bdM7yxWlclMlTcPgaRNw2iGioJ633gzx0Nj7sYbMGgeZeJv16SLNg6vTAlteoqxElefFGRjcZRD21EWn1VA4LrKu0vxa79vmHALSMYVf8tZOYojIHWrg9f4x2TKcltTaYX0ZSz7SZ0DmVShKwL48P3165PtnqnNAFhFpUCLb6xsbMBJE8RvdQRSECwuq0Axp8Jl1qH8wjyLZObwwceo3vxkJc7Y5smbQ5QFSi9dQMU0hnHHO9Gpya2ySgq8XkrohuEirv5rRtMgtBcC16N3UAtUTnfxolRUUAPtaWqY7yeiCK7M64hLNhtI2niGtkW3K9a2wgiwuKV4CEAcfE9SmRZEksKMb8vrlpQZCxkmduZHHLaFK4jBlFfiO9xg1kE0qPJGQ4iEElDb2ioScOPGF7ThhQWSfspLROPyh8ESuZsp56iK3WcNm7KxctBhfr5tSXrfPg8WGbiQdheRWbZjUfSd7292vTWCZoTo3cV9etImwS1u06GojKrFYvAeSEoASDolO4OJ", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("5rIW4WT8TuQkwTB2wCQctIDWJE0zuZgmEvZzSplyBDO9wFMIpYEpDnB3qqlUzhAl26EcS2yRpOcWPd3Ee9idoSkt2huPgBs3jyGgYFVKYpsvrC7LZgSZTqvqmUSM4qkXMcbKM5aElfXdr4U9NYGruoM4dStZx6UIUtLjKKkZPHUsfov7hVS7NmbRYSxL82IXjotCtv4lZ84zVOjMxRdDhRPCHK5TXLbQTBUJKOl2xpF8lHYfM1FVRqYjBg2lMEgHzW8AibdNLButKktiswJGj8SyW4RAJIxsPCmMLOBVCfzYmOQpiWCrXPUuxurWn93NLDuAOfK7sVLZDgyshIW78kqlBtYKHKd3e6ztMQO8KqlubruiIRjmqwAAmD4OVY7HcQw1JtamsFcs3vORNVo8Ubx0Am07WXWg0i8g4F7qjMPHjeEMwM8qcjJqoJSKFzaUE6zHG074tX8JkPMrPN5y5z4jkBfCLHNTENA9dOGszNt6qRO3Gmxe9H8fgE24pCxZt9o2IMtIh7CEAsQVOdberVh0iQlG1KURVbwdCrnmsToYhs9kMmcHNDahqEIQDtqKdbjmg23Octfct5dj2grivXUBfJ6iVJ2lyxsjlosVJv00UUxnk7fRFu2Go7ceL7g9I3WF2fgsC4OYeht4UQOVcvP0hzWlIeOPHf6kCHzjLlcVPZZgVR9ucgFSxmq9rHPQMo6VU9ujDtsEU91Ikcry2chO6yBwEGX32pkqa2j03lTD1lr1ICsGexzlv2g7DKx1KGjuHdNkcgvTxPK1FifxXeaV8Wcqb8LgHioeaMS4DrsBAvMUMuWIp02oJoD4LYBMoJ4m7Qb3zNS6UAGFWoaJ45mO3sg5mBYUN26iS7OfCOhA8JTkGk2bVsJvmOhe2MTT9ocxpTlTDT7qGmCLjtwV5xUKLJljjwl0nzN9SJHxBvEbhI9OeLGnHCEFcfu3hX44GVj53OXme3QncmsSVJeQVIv9SyTxtSr19OYixi2jUWD0XmZSmVfvXHzq7IkPO6I3bkSxyQFq1i8bBvojxH0OR5yS2m2WcXqPYy5UGsvofUMXX6BqwvogpTSUjPdQWcyxDeFb2jDWP3tqclGSxWYR8gg84zUA1wqmg2bFiNSFgbuQdrCVyEmPiB3rfm7F2bxGHhOsNVhkYqqDF4p6Wks27SEt8hfqfEigt2TXCrN8byE6lZexggnJir6zsIUEC0OcsHBdEeBZGScMsC8EhdARaMBY2W4d8B6TAdupQQpNb2HclpCZ12YEZWl1Twky7", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("bqsMZ5imCnxLLC3UNC9JBqcHYEEnnq6aznf12XkFQtpcS4XKtxWXNd4EkDl391wA3SS3kY9PVWBPiZzTJd4cHxzzQmAxMBDjNNpynjoMpFSGEw5PmDTMUI8VXlw7Aq5wNRj0Z2Q4h6dM2Us8IZPDPjmT0TUcqdbeA0T7D2TtXk9HCX0geULM27JJNHfgzYCphtkzn0x4uzhcM3femSsrUDXJds8MOA2h9ijk008zcIZ0NrvAe6qPelXdLp3q0Vl6FDOmebskWeCBhw7uHtxsnM836qtpto0BLTninfGtMDEZ8vIzud6W6WWJoxr4wM9xlnDsykutZqigpUbFerzU5N1QyTyE5Itp49tWI3j0r0knZBGiNzHOIbJhJmzoL10QUHEkVXHmwLKUvyDHLruaO29UxyTgn6jBgDLHeC3a4ig5wXLpF4cIGIXgw89ljeKWKnnQHZ3DBtd8TV8bGaHSHpC4snBkqobF55lodLI5TdIZN0oLFOvyhnGxWPA0P4TP97SsFbdrYOwngAjlXRIW64wQTTIsdAlrOfKNAk6fDwdlxaW6ELG6LiFIq7Rkk9aDapSjQrzWT6AFmGuOaUyoOywEYERXQyoU9ntwTX1gMHGRwA6mYpa6lKjGKd3NvVw915kuQkWHmxXIIAAdjo92E5seTDiktF647dC8qxd4YhXqh7Rq9ArG8HWblb2STHzFrFPS6O8eKxUzogpAjFzkmSzquETg03pDnIhM4GLgcMzo6nPbmXGbMvcZXvknqiJlEfgLH1TcG0MRI36syignIGgfQt6yzomOjoPDJU50YHrSBzTKnUcZlIhK0CFBt169JtzPd0wft4AYfdNKcHgKzST8nHDfEtTIY0Zjd5DO2jX58iregSX9AU7vuANmVatcqsWQwm8nSfewoFuzULuOIvmRhwgyzkvFQG5TA2bWLh46BFNAvQhrt4KeMeVdE4ecakKUrjBrFnu0yrUsmx7J5tuplUbNJgekYyXRAtc3oSYKg9Ht6V3a2kOUYagc2tqlQ35giEmfauo6AWySHSEWFvxSu8U3izRmFacLJDdWqnDxWdT8GPfwPOyCgiCxuhdDWAJExxRV9XNVK1HH0aaIQDaro4SyMNS8jZiOjXTgo42GzN3FwnzrMiQWQ6cBEANyWZuJ536vWEBoiTRviLoXWUl3k8EbRsATy3r6pm9GQ0V9Cw1MCVLOEQ4LNGUC7f0UTdqOCXhkaRGdQXYvrKRjV9cgnxgWbw3VeTnAHmc0oRS5CxMgzPfeXLEsFAq2jNCjLEzgnp4AVii5OAzi0Rj4iEERNiLgzaujk2VMiAQ7tAz6QLXLNPuIHi7Vsc3TEpsd", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
	prime, _ = new(big.Int).SetString("vyMFvw0lAs3rjt3uoRhfZKTJi1mOtsfHBxB3xFyto8I0YoB8ttvZtBPOxY6TYWxvqRMPjMclN6sr9N5wAZoXsv8CIjuVYrGMhvMvdaedyi1N1vcuvY8q7k163HOFyD6D5QNbVm1gNtGGFcWGMYUcHBD7OySJ4FLBXohr1gZtH0qZx1md6tQxI9VLBGBQEaOHKzL7YMtrzNkJAkQgHLtDljiKWvpcKpI1QKAx4u3xKdun96R9KLYmUVp5XVMEtbuo5zQkniuUe87bRHBO0OzUJOIjb77XJ6kngu83RtK7RkE6mmNix7fNjldgyNOOrdMKsTBhYLg6Wdqz4vZtr3zjqNbG7kDYVnPAkc4cw3Oz8PuulS10pHc0Y9gT7VNmHY5HHLbiydpFg2lem54Hww7kdhPxckLMf5SPK6dLXAytvMBVC1OKL21X5oTVbMRG6ojstbmr2K0yRbkz98rXKDnFZs5PImAEeyGMc25V2bpaxe67WemN5hPQahZeSLgIdNlbG8honIKRDF4ARYAawX09NzME5Gh6VTsin9xn2oaqXgwr0U3BN2CV6tyQjTSTrlQTkRC0f8FLqm0QqN8BZH00iEJ39FzNZO0h9R5Ifmbid1PVPStWKaNuScxBIjsge8Ow1RiEqm08aS7X2WdWeoYi3UGefUxng5BO2hbmPaWBQYWh2zLm2OhEDPZFTMauI0r9CsLSZbkZsuVv9JM30sV878481XkMpIK7Z0iXs0TZARvDRbwaVAoH06otqDefhCBJz60uC6o7kamdsMLKWhBxujdSfyn7YzDS4OCu8MiPmc9Ic4bJtQyjrPgAdSf8sJXFINe4959V1l9jasj9eDgoCDwhwwY6EW0DITP6enR3jU3tpwtWYkh2STe3308NrvDuPacFA2aIOh0h6u7BrGAvFgBJwHOg8woXgJTdQDYQuP9qmRRh0rKG2cdYzT0kiq9CxjqkSn0zNKdlix54yiU7f9yGJUXRGK0GlIlvDfTKBMqq8iByTwLqAcoRyLUgK6SOz4dYaA9udEGkj9rP3FFuZRN7W7TvrkwL1g7ddgoeJEQuW7H6QHUXyuWp8PpM5IVYO8V8mbhVghaxMGLK0GdJ1j05NbcFWgrxzP08EUQoTI0QrMyX61mfsNTKGf1RzOo5ywpvcY1eECWlutxY8sD7MLej4BlOzEDVdtAWQJbThARuUxMvqAoca9yPpWgVPVMEdsXZ7MHtol35DFmBHCv1wqh7JK0VcoazlHwVOah57ZrLmvq2WeoGEywbB1iXKoUO32OE5CnSesIL01MDdAzV20PdNUzQfyz2B47Nisptg74NsERQi3nSQiECgT6v8jPALVjFVQacAZ28LWfsEptVAkApo2nzg64x", big.MaxBase)
	fastPrimes = append(fastPrimes, prime)
}

var incrementalSize = big.NewInt(1)

// NextPrime 返回 > num 的第一个素数
func NextPrime(num *big.Int) *big.Int {
	if num.Cmp(big.NewInt(3)) < 0 {
		return big.NewInt(2)
	}

	result := new(big.Int).Set(num)
	result.Add(result, incrementalSize)

	for !result.ProbablyPrime(defaultTestTimes) {
		result.Add(result, incrementalSize)
	}

	return result
}

// FastPrime 快速返回 >= num 的一个素数
// 这个函数将会从预先配置的素数列表里找，若找不到最终会调用 NextPrime
func FastPrime(num *big.Int) *big.Int {
	if num.Cmp(big.NewInt(3)) < 0 {
		return big.NewInt(2)
	}

	for _, prime := range fastPrimes {
		if prime.Cmp(num) > 0 {
			return new(big.Int).Set(prime)
		}
	}

	return NextPrime(num)
}

// GetSecretMaxLen 返回单个秘密byte最大长度，超过此长度需要再计算素数，此长度后的素数计算时间较久
func GetSecretMaxLen() int {
	return len(fastPrimes[len(fastPrimes)-1].Bytes()) - 1
}

// GetSecretMaxLenNoFast 返回在非快速加密场景下单个秘密byte最大长度，超过此长度需要再计算素数，此长度后的素数计算时间较久
func GetSecretMaxLenNoFast() int {
	return secretMaxLenNoFast
}
